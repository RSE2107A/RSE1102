
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.2.11">
    
    
      
        <title>ROS2 Workspace and Package - CodeMine≈ Gold Mining for Coders and Robotics Developers</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c5ef100.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ros2-python-package-for-pixy2-detection-pixy2_uart_pkg" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CodeMine≈ Gold Mining for Coders and Robotics Developers" class="md-header__button md-logo" aria-label="CodeMine≈ Gold Mining for Coders and Robotics Developers" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CodeMine≈ Gold Mining for Coders and Robotics Developers
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ROS2 Workspace and Package
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CodeMine≈ Gold Mining for Coders and Robotics Developers" class="md-nav__button md-logo" aria-label="CodeMine≈ Gold Mining for Coders and Robotics Developers" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CodeMine≈ Gold Mining for Coders and Robotics Developers
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ubuntu24/" class="md-nav__link">
        Ubuntu24.04 Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ros2_jazzy_installation/" class="md-nav__link">
        ROS2 Jazzy Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pixy2_installation/" class="md-nav__link">
        Pixy2 Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../UART/" class="md-nav__link">
        UART Setup
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ROS2 Workspace and Package
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ROS2 Workspace and Package
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-of-python3-serial" class="md-nav__link">
    Installation of python3-serial
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-guide" class="md-nav__link">
    Setup Guide
  </a>
  
    <nav class="md-nav" aria-label="Setup Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-setup-ros-2-jazzy-environment" class="md-nav__link">
    1. Setup ROS 2 Jazzy environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-the-python-package-inside-the-workspace" class="md-nav__link">
    3. Create the Python package inside the workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-add-the-node-script" class="md-nav__link">
    4. Add the node script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-edit-setuppy" class="md-nav__link">
    5. Edit setup.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-build-the-workspace" class="md-nav__link">
    6. Build the workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-source-your-workspace" class="md-nav__link">
    7. Source your workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-run-the-pixy2-uart-node" class="md-nav__link">
    8. Run the Pixy2 UART node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../P1/" class="md-nav__link">
        Propeller P1 Communication with Pi
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation-of-python3-serial" class="md-nav__link">
    Installation of python3-serial
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-guide" class="md-nav__link">
    Setup Guide
  </a>
  
    <nav class="md-nav" aria-label="Setup Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-setup-ros-2-jazzy-environment" class="md-nav__link">
    1. Setup ROS 2 Jazzy environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-create-the-python-package-inside-the-workspace" class="md-nav__link">
    3. Create the Python package inside the workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-add-the-node-script" class="md-nav__link">
    4. Add the node script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-edit-setuppy" class="md-nav__link">
    5. Edit setup.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-build-the-workspace" class="md-nav__link">
    6. Build the workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-source-your-workspace" class="md-nav__link">
    7. Source your workspace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-run-the-pixy2-uart-node" class="md-nav__link">
    8. Run the Pixy2 UART node
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="ros2-python-package-for-pixy2-detection-pixy2_uart_pkg">ROS2 Python Package for Pixy2 Detection: pixy2_uart_pkg<a class="headerlink" href="#ros2-python-package-for-pixy2-detection-pixy2_uart_pkg" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p><strong>pixy2_uart_pkg</strong> is a Python ROS 2 Jazzy package that interfaces with the Pixy2 vision sensor via UART communication. It initializes the Pixy2 using the Pixy SDK, reads detected object blocks at 10 Hz, publishes the block count on a ROS 2 topic (<code>/pixy_block_count</code>), and sends the count over UART to an external device.</p>
<p>This package allows ROS 2 applications to integrate Pixy2 sensor data and communicate with external hardware using UART.</p>
<hr />
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<ul>
<li>ROS 2 Jazzy installed and properly sourced</li>
<li>Pixy2 SDK and Python bindings installed</li>
<li><code>python3-serial</code> Python package installed for UART communication</li>
<li>A Pixy2 sensor connected to the UART port <code>/dev/ttyAMA0</code> or update accordingly</li>
</ul>
<hr />
<h2 id="installation-of-python3-serial">Installation of python3-serial<a class="headerlink" href="#installation-of-python3-serial" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>sudo apt update
sudo apt install python3-serial
</code></pre></div>
<h2 id="setup-guide">Setup Guide<a class="headerlink" href="#setup-guide" title="Permanent link">&para;</a></h2>
<h3 id="1-setup-ros-2-jazzy-environment">1. Setup ROS 2 Jazzy environment<a class="headerlink" href="#1-setup-ros-2-jazzy-environment" title="Permanent link">&para;</a></h3>
<p>Open a terminal and source your ROS 2 Jazzy installation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> /opt/ros/jazzy/setup.bash
<span class="sb">````</span>

<span class="c1">### 2. Create a ROS 2 workspace (if you don’t have one)</span>

<span class="sb">```</span>bash
mkdir -p ~/ros2_ws/src
<span class="nb">cd</span> ~/ros2_ws
colcon build
<span class="nb">source</span> install/setup.bash
</code></pre></div>
<h3 id="3-create-the-python-package-inside-the-workspace">3. Create the Python package inside the workspace<a class="headerlink" href="#3-create-the-python-package-inside-the-workspace" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/ros2_ws/src
ros2 pkg create --build-type ament_python pixy2_uart_pkg
</code></pre></div>
<p>This creates the package folder structure with essential setup files.</p>
<h3 id="4-add-the-node-script">4. Add the node script<a class="headerlink" href="#4-add-the-node-script" title="Permanent link">&para;</a></h3>
<p>Inside the package folder, create <code>pixy2_uart_node.py</code> under <code>pixy2_uart_pkg/</code> with the following content:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>
<span class="kn">import</span> <span class="nn">pixy</span>
<span class="kn">from</span> <span class="nn">pixy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">serial</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">class</span> <span class="nc">PixyUARTNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;pixy_uart_publisher&#39;</span><span class="p">)</span>

        <span class="c1"># ROS 2 publisher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">Int32</span><span class="p">,</span> <span class="s1">&#39;pixy_block_count&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Pixy2 init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Initializing Pixy2...&quot;</span><span class="p">)</span>
        <span class="n">pixy</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">pixy</span><span class="o">.</span><span class="n">change_prog</span><span class="p">(</span><span class="s2">&quot;color_connected_components&quot;</span><span class="p">)</span>

        <span class="c1"># UART init</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uart</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/ttyAMA0&#39;</span><span class="p">,</span> <span class="n">baudrate</span><span class="o">=</span><span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;UART connected on /dev/ttyAMA0&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to open UART port: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uart</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Block buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="n">BlockArray</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Timer: 10 Hz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_timer</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer_callback</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">pixy</span><span class="o">.</span><span class="n">ccc_get_blocks</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="si">}</span><span class="s1"> - Detected </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1"> blocks&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Publish block count</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">Int32</span><span class="p">()</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">count</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher_</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="c1"># Send via UART</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uart</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">uart</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">([</span><span class="n">count</span><span class="p">]))</span>  <span class="c1"># send as a single byte</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UART write error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">PixyUARTNode</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">spin</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">node</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Shutting down.&#39;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">uart</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">uart</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">node</span><span class="o">.</span><span class="n">destroy_node</span><span class="p">()</span>
        <span class="n">rclpy</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<p>Make sure the script is executable:</p>
<div class="highlight"><pre><span></span><code>chmod +x ~/ros2_ws/src/pixy2_uart_pkg/pixy2_uart_pkg/pixy2_uart_node.py
</code></pre></div>
<h3 id="5-edit-setuppy">5. Edit <code>setup.py</code><a class="headerlink" href="#5-edit-setuppy" title="Permanent link">&para;</a></h3>
<p>Modify the <code>setup.py</code> file in the <code>pixy2_uart_pkg</code> folder to register the node as a console script:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">package_name</span> <span class="o">=</span> <span class="s1">&#39;pixy2_uart_pkg&#39;</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">package_name</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.0.0&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="p">[</span><span class="n">package_name</span><span class="p">],</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;setuptools&#39;</span><span class="p">,</span> <span class="s1">&#39;pyserial&#39;</span><span class="p">],</span>
    <span class="n">zip_safe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">maintainer</span><span class="o">=</span><span class="s1">&#39;Your Name&#39;</span><span class="p">,</span>
    <span class="n">maintainer_email</span><span class="o">=</span><span class="s1">&#39;your.email@example.com&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Python package for Pixy2 UART communication in ROS 2 Jazzy&#39;</span><span class="p">,</span>
    <span class="n">license</span><span class="o">=</span><span class="s1">&#39;Apache License 2.0&#39;</span><span class="p">,</span>
    <span class="n">tests_require</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pytest&#39;</span><span class="p">],</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;pixy2_uart_node = pixy2_uart_pkg.pixy2_uart_node:main&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="6-build-the-workspace">6. Build the workspace<a class="headerlink" href="#6-build-the-workspace" title="Permanent link">&para;</a></h3>
<p>Go to the root of your workspace and build with colcon:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> ~/ros2_ws
colcon build
</code></pre></div>
<h3 id="7-source-your-workspace">7. Source your workspace<a class="headerlink" href="#7-source-your-workspace" title="Permanent link">&para;</a></h3>
<p>After building, source your workspace overlay:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span> install/setup.bash
</code></pre></div>
<h3 id="8-run-the-pixy2-uart-node">8. Run the Pixy2 UART node<a class="headerlink" href="#8-run-the-pixy2-uart-node" title="Permanent link">&para;</a></h3>
<p>Run your node with:</p>
<div class="highlight"><pre><span></span><code>ros2 run pixy2_uart_pkg pixy2_uart_node
</code></pre></div>
<p>You should see log messages indicating Pixy2 initialization, block detections, and UART transmissions.</p>
<hr />
<h2 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h2>
<ul>
<li>Adjust UART device path (<code>/dev/ttyAMA0</code>) if your hardware uses a different port.</li>
<li>Ensure Pixy2 SDK Python bindings and <code>python3-serial</code> are installed in your environment.</li>
<li>This node publishes the detected block count as a standard <code>Int32</code> ROS 2 message, which can be subscribed to by other nodes.</li>
</ul>
<hr />
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">&para;</a></h2>
<p>This project is licensed under the Apache License 2.0.</p>
<hr />

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../UART/" class="md-footer__link md-footer__link--prev" aria-label="Previous: UART Setup" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              UART Setup
            </div>
          </div>
        </a>
      
      
        
        <a href="../P1/" class="md-footer__link md-footer__link--next" aria-label="Next: Propeller P1 Communication with Pi" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Propeller P1 Communication with Pi
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.748e2769.min.js"></script>
      
    
  </body>
</html>